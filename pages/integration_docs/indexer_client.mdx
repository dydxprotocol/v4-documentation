import { Tab, Tabs } from "nextra-theme-docs";

# Indexer Client

## Getting Started

### Installation

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
pnpm install @dydxprotocol/v4-client
```
</Tab>
<Tab>
```python copy
pip install dydx4
```
</Tab>
</Tabs>

### Initializing the Client

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
import { IndexerClient } from "@dydxprotocol/v4-client";

const client = new IndexerClient(Network.testnet().indexerConfig);
```
</Tab>
<Tab>
```python copy
from dydx4 import IndexerClient

client = IndexerClient(
    config=Network.testnet().indexer_config,
)
```
</Tab>
</Tabs>

## Indexer Status

### Get Block Height and Block Time parsed by Indexer

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
const response = await client.utility.getHeight();
const height = response.height;
const heightTime = response.time;
```
</Tab>
<Tab>
```python copy
height_response = client.utility.get_height()
height = height_response.data['height']
height_time = height_response.data['time']
```
</Tab>
</Tabs>



### Get Server Time

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
const response = await client.utility.getTime();
const timeIso = response.iso;
const timeEpoch = response.epoch;
```
</Tab>
<Tab>
```python copy
time_response = client.utility.get_time()
time_iso = time_response.data['iso']
time_epoch = time_response.data['epoch']
```
</Tab>
</Tabs>

## Markets

### List Perpetual Markets

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
const response = await client.markets.getPerpetualMarkets();
```
</Tab>
<Tab>
```python copy
markets_response = client.markets.get_perpetual_markets()
```
</Tab>
</Tabs>


**Params and Response**: See *<a id="listPerpetualMarkets" href="/integration_docs/indexer_api#listperpetualmarkets">Indexer API</a>*



### List Sparklines

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
const response = await client.markets.getPerpetualMarketSparklines();
```
</Tab>
<Tab>
```python copy
sparklines_response = client.markets.get_perpetual_markets_sparklines()
```
</Tab>
</Tabs>


**Params and Response**: See *<a id="listPerpetualMarkets" href="/integration_docs/indexer_api#listperpetualmarkets">Indexer API</a>*


### Get Perpetual Markets

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// ticker is the market ticket, such as "BTC-USD"
const response = await client.markets.getPerpetualMarket(ticker);
```
</Tab>
<Tab>
```python copy
# ticker is the market ticket, such as "BTC-USD"
markets_response = client.markets.get_perpetual_markets(ticker)
```
</Tab>
</Tabs>


**Params and Response**: See *<a id="getPerpetualMarket" href="/integration_docs/indexer_api#listperpetualmarkets">Indexer API</a>*


### Get Orderbook

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// ticker is the market ticket, such as "BTC-USD"
const response = await client.markets.getPerpetualMarketOrderbook(ticker);
const asks = response.asks;
const bids = response.bids;
```
</Tab>
<Tab>
```python copy
# ticker is the market ticket, such as "BTC-USD"
market_orderbook_response = client.markets.get_perpetual_market_orderbook(ticker)
market_orderbook = market_orderbook_response.data
market_orderbook_asks = btc_market_orderbook['asks']
market_orderbook_bids = btc_market_orderbook['bids']
```
</Tab>
</Tabs>


**Params and Response**: See *<a id="getPerpetualMarketOrderbook" href="/integration_docs/indexer_api">Indexer API</a>*


### Get Trades

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// ticker is the market ticket, such as "BTC-USD"
const response = await client.markets.getPerpetualMarketTrades(ticker);
const trades = response.trades;
```
</Tab>
<Tab>
```python copy
# ticker is the market ticket, such as "BTC-USD"
market_trades_response = client.markets.get_perpetual_market_trades(ticker)
market_trades = btc_market_trades_response.data['trades']
```
</Tab>
</Tabs>


**Params and Response**: See *<a id="getPerpetualMarketTrades" href="/integration_docs/indexer_api#gettrades">Indexer API</a>*


### Get Historical Funding

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// ticker is the market ticket, such as "BTC-USD"
const response = await client.markets.getPerpetualMarketHistoricalFunding(ticker);
const historicalFunding = response.historicalFunding;
```
</Tab>
<Tab>
```python copy
# ticker is the market ticket, such as "BTC-USD"
market_funding_response = client.markets.get_perpetual_market_funding(ticker)
market_funding = market_funding_response.data['historicalFunding']
```
</Tab>
</Tabs>


**Params and Response**: See *<a id="getPerpetualMarketFunding" href="/integration_docs/indexer_api#gethistoricalfunding">Indexer API</a>*



### Get Candles

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// ticker is the market ticket, such as "BTC-USD", resolution is the resolution of the candles, such as "1MIN"
const response = await client.markets.getPerpetualMarketCandles(ticket, resolution);
const candles = response.candles;
```
</Tab>
<Tab>
```python copy
# ticker is the market ticket, such as "BTC-USD"
market_candles_response = client.markets.get_perpetual_market_candles(ticket, resolution)
market_candles = market_candles_response.data['candles']
```
</Tab>
</Tabs>


**Params and Response**: See *<a id="getPerpetualMarketCandles" href="/integration_docs/indexer_api#getcandles">Indexer API</a>*

## Subaccount

### Get Address Subaccounts

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// address is the wallet address on dYdX chain
const response = await client.account.getSubaccounts(address);
const subaccounts = response.subaccounts;
```
</Tab>
<Tab>
```python copy
# address is the wallet address on dYdX chain
subaccounts_response = client.account.get_subaccounts(address)
subaccounts = subaccounts_response.data['subaccounts']
```
</Tab>
</Tabs>

**Params and Response**: See *<a id="listSubaccounts" href="/integration_docs/indexer_api#getaddress">Indexer API</a>*


### Get Subaccount

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// address is the wallet address on dYdX chain, subaccountNumber is the subaccount number
const response = await client.account.getSubaccount(address, subaccountNumber);
const subaccounts = response.subaccount;
```
</Tab>
<Tab>
```python copy
# address is the wallet address on dYdX chain, subaccount_number is the subaccount number
subaccount_response = client.account.get_subaccount(address, subaccount_number)
subaccount = subaccount_response.data['subaccount']
```
</Tab>
</Tabs>

**Params and Response**: See *<a id="getSubaccount" href="/integration_docs/indexer_api#getsubaccount">Indexer API</a>*


### Get Assets

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// address is the wallet address on dYdX chain, subaccountNumber is the subaccount number
const response = await client.account.getSubaccountAssetPositions(address, subaccountNumber);
const positions = response.positions;
```
</Tab>
<Tab>
```python copy
# address is the wallet address on dYdX chain, subaccount_number is the subaccount number
asset_positions_response = client.account.get_subaccount_asset_positions(address, subaccount_number)
asset_positions = asset_positions_response.data['positions']
```
</Tab>
</Tabs>

**Params and Response**: See *<a id="getAssets" href="/integration_docs/indexer_api#getsubaccount">Indexer API</a>*


### Get Perpetual Positions

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// address is the wallet address on dYdX chain, subaccountNumber is the subaccount number
const response = await client.account.getSubaccountPerpetualPositions(address, subaccountNumber);
const positions = response.positions;
```
</Tab>
<Tab>
```python copy
# address is the wallet address on dYdX chain, subaccount_number is the subaccount number
perpetual_positions_response = client.account.get_subaccount_perpetual_positions(address, subaccount_number)
perpetual_positions = perpetual_positions_response.data['positions']
```
</Tab>
</Tabs>

**Params and Response**: See *<a id="getPerpetualPositions" href="/integration_docs/indexer_api#listpositions">Indexer API</a>*


### Get Orders

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// address is the wallet address on dYdX chain, subaccountNumber is the subaccount number
const response = await client.account.getSubaccountOrders(address, subaccountNumber);
const orders = response;
```
</Tab>
<Tab>
```python copy
# address is the wallet address on dYdX chain, subaccount_number is the subaccount number
orders_response = client.account.get_subaccount_orders(address, subaccount_number)
orders = orders_response.data
```
</Tab>
</Tabs>

**Params and Response**: See *<a id="listOrders" href="/integration_docs/indexer_api#listorders">Indexer API</a>*


### Get Order

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// orderId is the ID of the order
const response = await client.account.getOrder(orderId);
const order = response;
```
</Tab>
<Tab>
```python copy
# order_id is the ID of the order
order_response = client.account.get_order(order_id)
order = order_response.data
```
</Tab>
</Tabs>

**Params and Response**: See *<a id="getOrder" href="/integration_docs/indexer_api#getorder">Indexer API</a>*


### Get Fills

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// address is the wallet address on dYdX chain, subaccountNumber is the subaccount number
const response = await client.account.getSubaccountFills(address, subaccountNumber);
const fills = response.fills;
```
</Tab>
<Tab>
```python copy
# address is the wallet address on dYdX chain, subaccount_number is the subaccount number
fills_response = client.account.get_subaccount_fills(address, subaccount_number)
fills = fills_response.data['fills']
```
</Tab>
</Tabs>

**Params and Response**: See *<a id="getFills" href="/integration_docs/indexer_api#getfills">Indexer API</a>*



### Get Transfers

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// address is the wallet address on dYdX chain, subaccountNumber is the subaccount number
const response = await client.account.getSubaccountTransfers(address, subaccountNumber);
const transfers = response.transfers;
```
</Tab>
<Tab>
```python copy
# address is the wallet address on dYdX chain, subaccount_number is the subaccount number
transfers_response = client.account.get_subaccount_transfers(address, subaccount_number)
transfers = transfers_response.data['transfers']
```
</Tab>
</Tabs>

**Params and Response**: See *<a id="getTransfers" href="/integration_docs/indexer_api#gettransfers">Indexer API</a>*


### Get Historical PNL

<Tabs items={["TypeScript", "Python"]}>
<Tab>
```typescript copy
// address is the wallet address on dYdX chain, subaccountNumber is the subaccount number
const response = await client.account.getSubaccountHistoricalPNLs(address, subaccountNumber);
const historicalPnl = response.historicalPnl;
```
</Tab>
<Tab>
```python copy
# address is the wallet address on dYdX chain, subaccount_number is the subaccount number
historical_pnl_response = client.account.get_subaccount_historical_pnls(address, subaccount_number)
historical_pnl = historical_pnl_response.data['historicalPnl']
```
</Tab>
</Tabs>

**Params and Response**: See *<a id="getFills" href="/integration_docs/indexer_api#gethistoricalpnl">Indexer API</a>*

